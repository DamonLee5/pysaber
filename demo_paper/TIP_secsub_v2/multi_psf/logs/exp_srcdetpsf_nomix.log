----------- Init stage: Estimation of only detector blur model parameters -----------
Will optimize detector blur parameters
----------------------------
Evaluating fit for parameters [2.0537694238813193]
Evaluating fit for parameters [2.0537694387824805]
eps is 1.4901161193847656e-08
Error in jacobian at [2.0537694238813193] is 7.567941453601179e-05. Numerical jacobian is [116.17272949]. True jacobian is [116.17280517]
###########################
Evaluating fit for parameters [2.0537694238813193]
Evaluating fit for parameters [1.0537694238813193]
Evaluating fit for parameters [1e-10]
Evaluating fit for parameters [0.7049023696396703]
Evaluating fit for parameters [0.2408324691248127]
Evaluating fit for parameters [0.5386848037005643]
Evaluating fit for parameters [0.5003269463213438]
Evaluating fit for parameters [0.06958738466641114]
Evaluating fit for parameters [0.37695336955337444]
Evaluating fit for parameters [0.49079467362816925]
Evaluating fit for parameters [0.4919365584561169]
Optimized parameters are [0.4919365584561169]
Estimated detector parameters are {'norm_power': 1.0, 'detector_weight_1': 1.0, 'cutoff_FWHM_2_multiplier': 10, 'cutoff_FWHM_1_multiplier': 10, 'detector_FWHM_2': 0.0, 'detector_FWHM_1': 2.8180348406522318}
4.14 mins has elapsed
----------- Init stage: Estimation of only source blur model parameters -----------
Will optimize source blur parameters
----------------------------
Evaluating fit for parameters [1.8349840987106336, 0.9174920493553168]
Evaluating fit for parameters [1.8349841136117948, 0.9174920493553168]
Evaluating fit for parameters [1.8349840987106336, 0.917492064256478]
eps is 1.4901161193847656e-08
Error in jacobian at [1.8349840987106336, 0.9174920493553168] is 5.284880573712898e-05. Numerical jacobian is [ 91.35031128 254.45223999]. True jacobian is [ 91.35029384 254.4521901 ]
###########################
Evaluating fit for parameters [1.8349840987106336, 0.9174920493553168]
Evaluating fit for parameters [0.9405569077009692, 0.4702784538748561]
Evaluating fit for parameters [1e-10, 1e-10]
Evaluating fit for parameters [0.6298242008821346, 0.3149121004739057]
Evaluating fit for parameters [0.39535919451927715, 0.19767959729886575]
Evaluating fit for parameters [0.5271492441011938, 0.26357462208623306]
Evaluating fit for parameters [0.5271492441011938, 0.26357462208623306]
Evaluating fit for parameters [1e-10, 1e-10]
Evaluating fit for parameters [0.35485024728775283, 0.17742512368420743]
Evaluating fit for parameters [0.47380882316631967, 0.23690441162024942]
Evaluating fit for parameters [0.3333781266274788, 0.2369637231103163]
Evaluating fit for parameters [0.25531673619165934, 0.2864957949778254]
Evaluating fit for parameters [0.3516215225654176, 0.33125552424557964]
Evaluating fit for parameters [0.3221624727326599, 0.3092363234649695]
Evaluating fit for parameters [0.30504765565322745, 0.29894988117740695]
Evaluating fit for parameters [0.30891151677085726, 0.3019855280739038]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839]
Optimized parameters are [0.3084680112235802, 0.3019880102081839]
Estimated source parameters are {'source_FWHM_x_axis': 4.494126816005867, 'norm_power': 1.0, 'cutoff_FWHM_multiplier': 10, 'source_FWHM_y_axis': 4.590560930429687}
12.20 mins has elapsed
-------- Final stage: Estimation of source, detector and transmission model parameters --------
Will optimize source blur parameters
Will optimize detector blur parameters
Will optimize transmission function parameters
----------------------------
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680261247414, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880251093451, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193657335727803, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176959991455078, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.992663100361824, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592126210863646, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711188688678, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.01781536638736725, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.9957347065210342, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.0166177898645401, 0.9952640533447266]
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640682458878]
eps is 1.4901161193847656e-08
Error in jacobian at [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266] is 0.009900398765182497. Numerical jacobian is [-239.05229568 -254.2538414  -275.84475708  306.59687424 -579.02779388
  419.42536163 -546.15118408  180.78849411 -400.46238708  240.96776199
 -382.09503555]. True jacobian is [-239.05229433 -254.25386585 -275.84471909  306.59338297 -579.03131339
  419.42180957 -546.15459452  180.78495589 -400.46586604  240.96418851
 -382.09847064]
###########################
Evaluating fit for parameters [0.3084680112235802, 0.3019880102081839, 0.49193655845611683, 0.019176945090293884, 0.9926630854606628, 0.018592111309702453, 0.9911711039677066, 0.017815351486206055, 0.995734691619873, 0.016617774963378906, 0.9952640533447266]
Evaluating fit for parameters [0.8458480179649082, 0.8735405423734762, 1.1120244660810563, 0.016885876037148136, 0.9949275385981776, 0.016302356939529472, 0.993438911020008, 0.015527343241082224, 0.9979922399094625, 0.014332458822431334, 0.997522659610355]
Evaluating fit for parameters [0.44151296602698376, 0.44349342510223977, 0.6454583988840377, 0.018609720454461874, 0.9932237205076606, 0.018025212164090584, 0.9917325693795032, 0.017248884647574965, 0.9962936171593182, 0.016051974637967443, 0.995823240818692]
Evaluating fit for parameters [0.4380580422412307, 0.4394339416678997, 0.6408195395796139, 0.029284726410508045, 0.9966683595710129, 0.022380385383302934, 0.994541804681065, 0.02889142163620892, 0.9963356279428008, 0.024488142821830282, 0.9952086842039876]
Evaluating fit for parameters [0.44131667533649127, 0.4432627864960698, 0.6451948431727025, 0.019216218432438856, 0.9934194268740445, 0.018272650316543862, 0.9918921754290992, 0.017910352675902328, 0.9962960039922005, 0.01653127356917681, 0.9957883249277122]
Evaluating fit for parameters [0.42285767542736324, 0.42361383914856765, 0.6238675788910963, 0.01917222734054689, 0.9932907235062879, 0.018298661751622213, 0.9917765868977312, 0.01784564435976258, 0.9962112909445151, 0.016503504818210887, 0.9957114944857727]
Evaluating fit for parameters [0.39238942283919914, 0.3907709253131944, 0.5885398077071026, 0.018446715482715557, 0.9965146934830443, 0.016632802527316266, 0.9946918990132435, 0.017725411468540668, 0.998541136671236, 0.015866925506250355, 0.997917551853704]
Evaluating fit for parameters [0.4191541249912307, 0.4196216381679932, 0.6195733325441005, 0.019084038175457247, 0.993682611271395, 0.018096169218160995, 0.9921309559389364, 0.017831029521729654, 0.9964944939648508, 0.01642612579617402, 0.9959796504853166]
Evaluating fit for parameters [0.4061941290283442, 0.40580771988144654, 0.6045940898566988, 0.019087943069918643, 0.9932938341977111, 0.01825522007245521, 0.991791475161973, 0.017765994572851933, 0.9962270733734171, 0.016443109611346058, 0.9957330215806722]
Evaluating fit for parameters [0.4080388724734767, 0.4077053750038468, 0.6067050306098082, 0.019082797501228644, 0.9933357076710967, 0.018228231899346636, 0.9918040411811773, 0.017782740148987414, 0.9962356194837797, 0.01645100684006522, 0.9957341771391364]
Evaluating fit for parameters [0.4083287438461529, 0.4078538752469199, 0.606994384240162, 0.019127511710918706, 0.9932642477875566, 0.018323821182862538, 0.9918638697602669, 0.01774172594687822, 0.9962851201132781, 0.016420746511153123, 0.9958117544375755]
Evaluating fit for parameters [0.4080910444204566, 0.40773210253729236, 0.6067571093719222, 0.01909084530310594, 0.993322846100046, 0.018245436354499947, 0.9918148093140471, 0.017775358285928265, 0.9962445287603109, 0.016445560492393766, 0.9957481397414577]
Optimized parameters are [0.4080910444204566, 0.40773210253729236, 0.6067571093719222, 0.01909084530310594, 0.993322846100046, 0.018245436354499947, 0.9918148093140471, 0.017775358285928265, 0.9962445287603109, 0.016445560492393766, 0.9957481397414577]
Blur estimation is complete.
Estimated source parameters are {'source_FWHM_x_axis': 3.3970222578361464, 'norm_power': 1.0, 'cutoff_FWHM_multiplier': 10, 'source_FWHM_y_axis': 3.4000127841125685}, detector parameters are {'norm_power': 1.0, 'detector_weight_1': 1.0, 'cutoff_FWHM_2_multiplier': 10, 'cutoff_FWHM_1_multiplier': 10, 'detector_FWHM_2': 0.0, 'detector_FWHM_1': 2.284759980076538}, and transmission function parameters are [[0.01909084530310594, 0.993322846100046], [0.018245436354499947, 0.9918148093140471], [0.017775358285928265, 0.9962445287603109], [0.016445560492393766, 0.9957481397414577]]
33.03 mins has elapsed
3.30e+01 mins has elapsed
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            1     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  6.22258D+02    |proj g|=  2.05377D+00

At iterate    1    f=  2.57917D+02    |proj g|=  5.00327D-01

At iterate    2    f=  2.57811D+02    |proj g|=  3.43224D+00

At iterate    3    f=  2.57809D+02    |proj g|=  1.12861D-01

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    1      3     11      3     0     0   1.129D-01   2.578D+02
  F =   257.80932531449633     

CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH             

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 0.000E+00 seconds.
 Line search           time 0.000E+00 seconds.

 Total User time 0.000E+00 seconds.

RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            2     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  8.30922D+02    |proj g|=  1.83498D+00

At iterate    1    f=  3.52477D+02    |proj g|=  3.20481D+02

At iterate    2    f=  3.45062D+02    |proj g|=  6.82165D+02

At iterate    3    f=  3.04534D+02    |proj g|=  6.85709D+02

At iterate    4    f=  2.95789D+02    |proj g|=  4.56012D+02

At iterate    5    f=  2.93999D+02    |proj g|=  3.51622D-01

At iterate    6    f=  2.86953D+02    |proj g|=  3.22162D-01

At iterate    7    f=  2.85931D+02    |proj g|=  2.00216D+01

At iterate    8    f=  2.85868D+02    |proj g|=  6.49066D-01

At iterate    9    f=  2.85868D+02    |proj g|=  5.98355D-01

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    2      9     17     10     0     0   5.984D-01   2.859D+02
  F =   285.86767978787105     

CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH             

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 0.000E+00 seconds.
 Line search           time 0.000E+00 seconds.

 Total User time 0.000E+00 seconds.

RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =           11     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  3.13290D+02    |proj g|=  2.75845D+02

At iterate    1    f=  2.82881D+02    |proj g|=  6.45458D-01

At iterate    2    f=  2.82609D+02    |proj g|=  1.01791D+00

At iterate    3    f=  2.79973D+02    |proj g|=  1.01917D+00

At iterate    4    f=  2.79878D+02    |proj g|=  1.01783D+00

At iterate    5    f=  2.79293D+02    |proj g|=  5.82185D+00

At iterate    6    f=  2.79285D+02    |proj g|=  3.50868D+00

At iterate    7    f=  2.79285D+02    |proj g|=  3.44819D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
   11      7     12     15     0     0   3.448D+00   2.793D+02
  F =   279.28459801227075     

CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH             

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 0.000E+00 seconds.
 Line search           time 0.000E+00 seconds.

 Total User time 0.000E+00 seconds.

